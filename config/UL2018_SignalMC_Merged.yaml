era: "UL2018"
isMC: true
luminosity: 59.82
threads: 30

# configuration for MergedAnalysis.cpp
############################################################################################################
#! NOTE: number of "ntuple_path",  "skimTree_path",  "miniTree_path", and "cross_section" should be the same.
ntuple_path:
  - "/data5/ggNtuples/V10_06_30_02/job_UL18_Dalitz_eeg_m125/*.root"
  - "/data5/ggNtuples/V10_06_30_02/job_UL18_Dalitz_eeg_VBF_m125/*.root"
  - "/data5/ggNtuples/V10_06_30_02/job_UL18_Dalitz_eeg_WH_m125/*.root"
  - "/data5/ggNtuples/V10_06_30_02/job_UL18_Dalitz_eeg_ZH_m125/*.root"
  - "/data5/ggNtuples/V10_06_30_02/job_UL18_Dalitz_eeg_ttH_m125/*.root"
  - "/data5/ggNtuples/V10_06_30_02/job_UL18_Dalitz_eeg_bbH_m125/*.root"

  - "/data5/ggNtuples/V10_06_30_02/job_UL18_Dalitz_eeg_m120/*.root"
  - "/data5/ggNtuples/V10_06_30_02/job_UL18_Dalitz_eeg_VBF_m120/*.root"
  - "/data5/ggNtuples/V10_06_30_02/job_UL18_Dalitz_eeg_WH_m120/*.root"
  - "/data5/ggNtuples/V10_06_30_02/job_UL18_Dalitz_eeg_ZH_m120/*.root"
  - "/data5/ggNtuples/V10_06_30_02/job_UL18_Dalitz_eeg_ttH_m120/*.root"
  - "/data5/ggNtuples/V10_06_30_02/job_UL18_Dalitz_eeg_bbH_m120/*.root"

  - "/data5/ggNtuples/V10_06_30_02/job_UL18_Dalitz_eeg_m130/*.root"
  - "/data5/ggNtuples/V10_06_30_02/job_UL18_Dalitz_eeg_VBF_m130/*.root"
  - "/data5/ggNtuples/V10_06_30_02/job_UL18_Dalitz_eeg_WH_m130/*.root"
  - "/data5/ggNtuples/V10_06_30_02/job_UL18_Dalitz_eeg_ZH_m130/*.root"
  - "/data5/ggNtuples/V10_06_30_02/job_UL18_Dalitz_eeg_ttH_m130/*.root"
  - "/data5/ggNtuples/V10_06_30_02/job_UL18_Dalitz_eeg_bbH_m130/*.root"

# skimTree_path:
#   - "/data4/chenghan/electron/skimTree/job_UL18_Dalitz_eeg_m125.root"
#   - "/data4/chenghan/electron/skimTree/job_UL18_Dalitz_eeg_VBF_m125.root"
#   - "/data4/chenghan/electron/skimTree/job_UL18_Dalitz_eeg_WH_m125.root"
#   - "/data4/chenghan/electron/skimTree/job_UL18_Dalitz_eeg_ZH_m125.root"
#   - "/data4/chenghan/electron/skimTree/job_UL18_Dalitz_eeg_ttH_m125.root"
#   - "/data4/chenghan/electron/skimTree/job_UL18_Dalitz_eeg_bbH_m125.root"

#   - "/data4/chenghan/electron/skimTree/job_UL18_Dalitz_eeg_m120.root"
#   - "/data4/chenghan/electron/skimTree/job_UL18_Dalitz_eeg_VBF_m120.root"
#   - "/data4/chenghan/electron/skimTree/job_UL18_Dalitz_eeg_WH_m120.root"
#   - "/data4/chenghan/electron/skimTree/job_UL18_Dalitz_eeg_ZH_m120.root"
#   - "/data4/chenghan/electron/skimTree/job_UL18_Dalitz_eeg_ttH_m120.root"
#   - "/data4/chenghan/electron/skimTree/job_UL18_Dalitz_eeg_bbH_m120.root"

#   - "/data4/chenghan/electron/skimTree/job_UL18_Dalitz_eeg_m130.root"
#   - "/data4/chenghan/electron/skimTree/job_UL18_Dalitz_eeg_VBF_m130.root"
#   - "/data4/chenghan/electron/skimTree/job_UL18_Dalitz_eeg_WH_m130.root"
#   - "/data4/chenghan/electron/skimTree/job_UL18_Dalitz_eeg_ZH_m130.root"
#   - "/data4/chenghan/electron/skimTree/job_UL18_Dalitz_eeg_ttH_m130.root"
#   - "/data4/chenghan/electron/skimTree/job_UL18_Dalitz_eeg_bbH_m130.root"

miniTree_path:
  - "/data4/chenghan/electron/miniTree_merged/UL2018/miniTree_HDalitz_ggF_eeg_125_UL2018.root"
  - "/data4/chenghan/electron/miniTree_merged/UL2018/miniTree_HDalitz_VBF_eeg_125_UL2018.root"
  - "/data4/chenghan/electron/miniTree_merged/UL2018/miniTree_HDalitz_WH_eeg_125_UL2018.root"
  - "/data4/chenghan/electron/miniTree_merged/UL2018/miniTree_HDalitz_ZH_eeg_125_UL2018.root"
  - "/data4/chenghan/electron/miniTree_merged/UL2018/miniTree_HDalitz_ttH_eeg_125_UL2018.root"
  - "/data4/chenghan/electron/miniTree_merged/UL2018/miniTree_HDalitz_bbH_eeg_125_UL2018.root"

  - "/data4/chenghan/electron/miniTree_merged/UL2018/miniTree_HDalitz_ggF_eeg_120_UL2018.root"
  - "/data4/chenghan/electron/miniTree_merged/UL2018/miniTree_HDalitz_VBF_eeg_120_UL2018.root"
  - "/data4/chenghan/electron/miniTree_merged/UL2018/miniTree_HDalitz_WH_eeg_120_UL2018.root"
  - "/data4/chenghan/electron/miniTree_merged/UL2018/miniTree_HDalitz_ZH_eeg_120_UL2018.root"
  - "/data4/chenghan/electron/miniTree_merged/UL2018/miniTree_HDalitz_ttH_eeg_120_UL2018.root"
  - "/data4/chenghan/electron/miniTree_merged/UL2018/miniTree_HDalitz_bbH_eeg_120_UL2018.root"

  - "/data4/chenghan/electron/miniTree_merged/UL2018/miniTree_HDalitz_ggF_eeg_130_UL2018.root"
  - "/data4/chenghan/electron/miniTree_merged/UL2018/miniTree_HDalitz_VBF_eeg_130_UL2018.root"
  - "/data4/chenghan/electron/miniTree_merged/UL2018/miniTree_HDalitz_WH_eeg_130_UL2018.root"
  - "/data4/chenghan/electron/miniTree_merged/UL2018/miniTree_HDalitz_ZH_eeg_130_UL2018.root"
  - "/data4/chenghan/electron/miniTree_merged/UL2018/miniTree_HDalitz_ttH_eeg_130_UL2018.root"
  - "/data4/chenghan/electron/miniTree_merged/UL2018/miniTree_HDalitz_bbH_eeg_130_UL2018.root"

# SM Higgs XS: https://twiki.cern.ch/twiki/bin/view/LHCPhysics/CERNYellowReportPageAt13TeV
cross_section:
  - 3.9301220  # (48.58  * 1000) * 8.09E-5
  - 0.30596380 # (3.782  * 1000) * 8.09E-5
  - 0.11107570 # (1.373  * 1000) * 8.09E-5
  - 0.07150751 # (0.8839 * 1000) * 8.09E-5
  - 0.04102439 # (0.5071 * 1000) * 8.09E-5
  - 0.03947920 # (0.4880 * 1000) * 8.09E-5

  - 4.1097140  # (52.22  * 1000) * 7.87E-5
  - 0.30968450 # (3.935  * 1000) * 7.87E-5
  - 0.12316550 # (1.565  * 1000) * 7.87E-5
  - 0.07821993 # (0.9939 * 1000) * 7.87E-5
  - 0.04483539 # (0.5697 * 1000) * 7.87E-5
  - 0.04355258 # (0.5534 * 1000) * 7.87E-5

  - 3.6338620  # (45.31  * 1000) * 8.02E-5
  - 0.29168740 # (3.637  * 1000) * 8.02E-5
  - 0.09696180 # (1.209  * 1000) * 8.02E-5
  - 0.06334998 # (0.7899 * 1000) * 8.02E-5
  - 0.03640278 # (0.4539 * 1000) * 8.02E-5
  - 0.03451808 # (0.4304 * 1000) * 8.02E-5

# https://twiki.cern.ch/twiki/bin/viewauth/CMS/EgammaMiniAODV2#Applying_the_Energy_Scale_and_sm
# "PhiUp" and "PhiDown" are currently identical so only "RhoUp", "RhoDown" and "PhiUp" are needed for smearing
# Applying the systematic variations only to the MC
# comment the variation to skip the systematic variations
# jet energy variations are only needed for VBF category
variation:
  - "JERUp"
  - "JERDo"
  - "JECUp"
  - "JECDo"
  - "PhoNoR9Corr"
  - "PhoScaleStatUp"
  - "PhoScaleSystUp"
  - "PhoScaleGainUp"
  - "PhoScaleStatDo"
  - "PhoScaleSystDo"
  - "PhoScaleGainDo"
  - "PhoSigmaPhiUp"
  - "PhoSigmaRhoUp"
  - "PhoSigmaRhoDo"
  - "EleHDALScaleUp"
  - "EleHDALScaleDo"
  - "EleHDALSmearUp"
  - "EleHDALSmearDo"

external_files:
  mergedID_model: # XGBReader (xgboost/c_api.h)
    M2EB: "/data4/chenghan/external/MergedID/Output_Merged2GsfID_hyperTune_FullRun2ULWPPtWeiFinal_EB/XGB/XGB_modelXGB.txt"
    M2EE: "/data4/chenghan/external/MergedID/Output_Merged2GsfID_hyperTune_FullRun2ULWPPtWeiFinal_EE/XGB/XGB_modelXGB.txt"
    # M1EB: "/data4/chenghan/external/MergedID/Output_Merged1GsfID_hyperTune_FullRun2ULWPPtWeiFinal_EB/XGB/XGB_modelXGB.txt"
    # M1EE: "/data4/chenghan/external/MergedID/Output_Merged1GsfID_hyperTune_FullRun2ULWPPtWeiFinal_EE/XGB/XGB_modelXGB.txt"
  mergedID_wp:
    M2EB: 0.4283
    M2EE: 0.4479
    # M1EB: 0.4390
    # M1EE: 0.4381

  mergedReg_model: # XGBReader (xgboost/c_api.h)
    M2EB: "/data4/chenghan/external/RegressionFinal/XGBRegression_NoRobustScaling_EGMRegTarget_EB/XGB_Regression.txt"
    M2EE: "/data4/chenghan/external/RegressionFinal/XGBRegression_NoRobustScaling_EGMRegTarget_EE/XGB_Regression.txt"

  energy_correction: 
    energy_reg: # EnCalibrater and XGBReader (xgboost/c_api.h)
      - "/data4/chenghan/external/RegressionFinal/XGBRegression_NoRobustScaling_EGMRegTarget_EB/XGB_Regression.txt"
      - "/data4/chenghan/external/RegressionFinal/XGBRegression_NoRobustScaling_EGMRegTarget_EE/XGB_Regression.txt"
    resi_scale: 
      - "/data4/chenghan/external/Correction/EnScale_xgb_final_EB.root"
      - "/data4/chenghan/external/Correction/EnScale_xgb_final_EE.root"
    resi_smear: 
      - "/data4/chenghan/external/Correction/EnSmear_xgb_final_EB.root"
      - "/data4/chenghan/external/Correction/EnSmear_xgb_final_EE.root"

  HggPhoID_model: # XGBReader (xgboost/c_api.h)
    EB: "../external/tmva-to-xgboost/HggPhoID/PhoID_barrel_UL18_GJetMC_SATrain_BDTG_nTree2k_BDTG.weights.json"
    EE: "../external/tmva-to-xgboost/HggPhoID/PhoID_endcap_UL18_GJetMC_SATrain_BDTG_nTree2k_BDTG.weights.json"

  pileup_rewei: # PUWeightCalculator
    nominal:  "/data4/cmkuo/tools/pileup/UL2018/PUreweight/PUreweight_13TeV_2018_GoldenJSON_69200nb.root"
    up:       "/data4/cmkuo/tools/pileup/UL2018/PUreweight/PUreweight_13TeV_2018_GoldenJSON_72383nb.root"
    down:     "/data4/cmkuo/tools/pileup/UL2018/PUreweight/PUreweight_13TeV_2018_GoldenJSON_66016nb.root"

  # https://twiki.cern.ch/twiki/bin/view/CMS/EgammaUL2016To2018
  # https://github.com/cms-analysis/flashgg/blob/dev_legacy_runII/Systematics/python/flashggDiPhotonSystematics2018_Legacy_cfi.py
  scale_factors: # WeightHandler
    RecoEleGt20: # greater than 20
      file: "/data4/chenghan/external/ScaleFactor/RecoEleGt20/egammaEffi_ptAbove20.txt_EGM2D_UL2018.root"
      hist: "EGamma_SF2D"
    MissHitsTrk:
      file: "/data4/chenghan/external/ScaleFactor/MissHits/UL2018/egammaEffi.txt_EGM2D.root"
      hist: "EGamma_SF2D"
    MissHitsSubTrk:
      file: "/data4/chenghan/external/ScaleFactor/MissHits/UL2018/egammaEffi.txt_EGM2D.root"
      hist: "EGamma_SF2D"
    ConvVetoTrk:
      file: "/data4/chenghan/external/ScaleFactor/ConvVeto/UL2018/egammaEffi.txt_EGM2D.root"
      hist: "EGamma_SF2D"
    MergedEleID: # note that this scale factors are measured in bins of abs(sceta) and pt 
      file: "/data4/chenghan/external/ScaleFactor/MergedID/MergedIDSFs_combined.root"
      hist: "hSF_2D"
    DiPhoHLTSeedForEle:
      file: "/data4/chenghan/external/ScaleFactor/DiPhoHLT/UL2018-Seed/egammaEffi.txt_EGM2D.root"
      hist: "EGamma_EffData2D"
    DiPhoHLTUnSeedForEle:
      file: "/data4/chenghan/external/ScaleFactor/DiPhoHLT/UL2018/egammaEffi.txt_EGM2D.root"
      hist: "EGamma_EffData2D"
    HggPreselForEle:
      absEta: [0.0, 1.5, 6]
      fullR9: [[0.0, 0.85, 999.], [0.0, 0.9, 999.]]
      values: [[1.0017, 0.9973], [1.0030 , 1.0031]]
      uncert: [[0.0237, 0.0067], [0.0210, 0.0024]]
    HggPreselForPho:
      absEta: [0.0, 1.5, 6]
      fullR9: [[0.0, 0.85, 999.], [0.0, 0.9, 999.]]
      values: [[1.0017, 0.9973], [1.0030 , 1.0031]]
      uncert: [[0.0237, 0.0067], [0.0210, 0.0024]]
    HggPhoCSEV:
      absEta: [0.0, 1.5, 6]
      fullR9: [[0.0, 0.85, 999.], [0.0, 0.9, 999.]]
      values: [[0.9830, 0.9939], [0.9603 , 0.9754]]
      uncert: [[0.0021, 0.0005], [0.0077, 0.0017]]
    HggPhoID:
      absEta: [0.0, 1.5, 6]
      fullR9: [[0.0, 0.85, 999.], [0.0, 0.9, 999.]]
      values: [[1.0022, 1.0005], [1.0058 , 1.0013]]
      uncert: [[0.0012, 0.0033], [0.0020, 0.0028]]
    DiPhoHLTSeedForPho:
      absEta: [0.0, 1.5, 3]
      fullR9: [[0.0, 0.56, 0.85, 999], [0.0, 0.85, 0.90, 999]]
      pt:     [0, 35, 37, 40, 45, 50, 60, 70, 90, 99999999]
      values: [
        [ 
          [0.6196012864, 0.7761489544, 0.8002387986, 0.8231650667, 0.8453928052, 0.8617735570, 0.8712109006, 0.8865923420, 0.8891188478], 
          [0.7976408633, 0.9473792086, 0.9578851687, 0.9606883609, 0.9638132287, 0.9653299268, 0.9708310992, 0.9811906983, 0.9858675076], 
          [0.8564371935, 0.9594766157, 0.9663358811, 0.9724797256, 0.9763581853, 0.9764434357, 0.9802652970, 0.9840348160, 0.9899930822]
        ],
        [ 
          [0.6595211482, 0.7445913750, 0.7721763963, 0.8107180165, 0.8439171883, 0.8596941548, 0.8831719219, 0.9172864768, 0.9417547952],
          [0.8923336432, 0.9732925196, 0.9778957733, 0.9824372073, 0.9867443152, 0.9875279678, 0.9905722669, 0.9875423811, 0.9939461454],
          [0.8832344791, 0.9780127017, 0.9798867348, 0.9842874232, 0.9884889713, 0.9865944794, 0.9874199891, 0.9901687777, 0.9939249798]
        ]]
      uncert: [
        [ 
          [0.0073267388, 0.0025113515, 0.0019198622, 0.0025080484, 0.0078622969, 0.0097098121, 0.0133002528, 0.0179465197, 0.0424957054], 
          [0.0012100047, 0.0010042354, 0.0035078869, 0.0011361977, 0.0011771561, 0.0018320733, 0.0013462303, 0.0026482376, 0.0012204025], 
          [0.0012903214, 0.0012742575, 0.0012090481, 0.0010947335, 0.0015287758, 0.0011321579, 0.0010207420, 0.0010310573, 0.0010104819]
        ],
        [ 
          [0.0035675804, 0.0023031514, 0.0065209097, 0.0014154022, 0.0036167742, 0.0059069771, 0.0076900377, 0.0076900377, 0.0069369473],
          [0.0018534140, 0.0010381313, 0.0016393361, 0.0010001192, 0.0016565749, 0.0016035797, 0.0024178380, 0.0018211930, 0.0014681992],
          [0.0015267508, 0.0010456392, 0.0010097728, 0.0010083699, 0.0015377887, 0.0010052555, 0.0012212860, 0.0023366205, 0.0019178013]
        ]]

    DiPhoHLTUnSeedForPho:
      absEta: [0.0, 1.5, 3]
      fullR9: [[0.0, 0.56, 0.85, 999], [0.0, 0.85, 0.90, 999]]
      pt:     [0, 28, 31, 35, 40, 45, 50, 60, 70, 90, 99999999]
      values: [
        [ 
          [0.6700566984, 0.7965842168, 0.8081304828, 0.8330735890, 0.8651728271, 0.8911488537, 0.9011784801, 0.9076775812, 0.9314218547, 0.8688854629], 
          [0.8894513966, 0.9884665549, 0.9917398218, 0.9933705148, 0.9942898736, 0.9942864841, 0.9944882129, 0.9957957201, 0.9968300712, 0.9955940296], 
          [0.8954487977, 0.9994025520, 0.9984810955, 0.9994189377, 0.9997816787, 0.9998486516, 0.9998481269, 0.9999123320, 0.9998477863, 0.9998191870]
        ],
        [ 
          [0.6077667927, 0.7029913014, 0.7348248590, 0.7751918056, 0.8177996767, 0.8498648292, 0.8663397128, 0.8949914647, 0.9172053758, 0.9422693522],
          [0.9353581676, 0.9899824821, 0.9871141083, 0.9904200761, 0.9918951123, 0.9917714091, 0.9928356527, 0.9938830616, 0.9943289581, 0.9953508596],
          [0.9363550975, 0.9971266544, 0.9982863440, 0.9990711368, 0.9994109362, 0.9995441995, 0.9995876301, 0.9994394094, 0.9997564478, 0.9997131724]
        ]]
      uncert: [
        [ 
          [0.0033591243, 0.0029087664, 0.0021488574, 0.0014600345, 0.0017961360, 0.0032747718, 0.0053724854, 0.0102298395, 0.0117083658, 0.0272240897], 
          [0.9955940296, 0.0015007956, 0.0011683208, 0.0010012892, 0.0010136787, 0.0010026866, 0.0011519019, 0.0010617143, 0.0010617143, 0.0010014183], 
          [0.0017249353, 0.0019219042, 0.0010594654, 0.0010043235, 0.0010001893, 0.0010000204, 0.0010010322, 0.0010002623, 0.0010002682, 0.0010000044]
        ],
        [ 
          [0.0046122696, 0.0043048501, 0.0025178296, 0.0022623129, 0.0015943345, 0.0043238986, 0.0053868895, 0.0080114689, 0.0072992270, 0.0065863094],
          [0.0018033312, 0.0018037358, 0.0013566255, 0.0011197038, 0.0010012658, 0.0010000000, 0.0017400600, 0.0014184516, 0.0012331963, 0.0012031112],
          [0.0011873982, 0.0011095861, 0.0010000850, 0.0010000639, 0.0010001205, 0.0010016283, 0.0010000157, 0.0010479168, 0.0010000844, 0.0010003946]
        ]]